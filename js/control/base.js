define(["knockout","underscore","draw","points"],function(n,t,a,o){function e(n){n=t(n).defaults({translate:{x:0,y:0},scale:1,origin:{x:0,y:0}}),n.scale=Math.max(.1,n.scale),a.zoom(l*n.scale),a.position({x:a.round(u.x-n.translate.x+(n.origin.x-n.translate.x+u.x)*(n.scale-1)),y:a.round(u.y-n.translate.y+(n.origin.y-n.translate.y+u.y)*(n.scale-1))})}function s(t){var o=n.dataFor(t.target);o&&o._shape&&a.select(o)}function i(){f=1,l=a.zoom(),u=a.position(),a.transforming(!0)}function r(n){x||(i(),d=n.position),f*=1+n.delta,e({origin:d,scale:f}),x=!0}function c(n){e({origin:n.position,scale:n.scale,translate:{x:n.distanceX,y:n.distanceY}}),x=!0}var l,u,f,d,x=!1;return a.debounce.subscribe(function(){x&&a.transforming(!1),x=!1}),{tap:s,hold:s,wheel:r,transformstart:i,transform:c}});