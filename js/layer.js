define(["knockout","underscore","util/kosvgtemplate","shape/factory"],function(e,s,t,i){var a=function(i){i=s(i||{}).defaults({name:"",visible:!0,shapes:[]}),this.name=e.observable(i.name),this.visible=e.observable(i.visible),this._destroy=e.observable(!1),this.shapes=e.observableArray(i.shapes),this.shapesTemplate=t(this.shapes,function(e){return"<"+e.type+' data-bind="visible:visible,aniattr:attr" />'})},n=function(e){var s=i(e);return s.layer=this,this.shapes.push(s),s},r=function(){return{name:this.name(),visible:this.visible(),shapes:s.chain(this.shapes()).filter(function(e){return e.visible()}).invoke("get").value()}};return s(a.prototype).extend({newShape:n,get:r}),a});